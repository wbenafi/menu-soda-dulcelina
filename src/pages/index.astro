---
import "../styles/global.css";

const menuImages = [
  { id: "inicio", label: "Inicio", src: "/assets/smaller/inicio.webp", alt: "Soda Dulcelina: portada del menú" },
  { id: "desayunos", label: "Desayunos", src: "/assets/smaller/desayunos.webp", alt: "Soda Dulcelina: sección desayunos" },
  { id: "entradas", label: "Entradas", src: "/assets/smaller/entradas.webp", alt: "Soda Dulcelina: sección entradas" },
  { id: "platos-fuertes-1", label: "Arroces", src: "/assets/smaller/platosfuertes.webp", alt: "Soda Dulcelina: platos fuertes parte 1" },
  { id: "platos-fuertes-2", label: "Casados", src: "/assets/smaller/platosfuertes2.webp", alt: "Soda Dulcelina: platos fuertes parte 2" },
  { id: "gallos", label: "Gallos", src: "/assets/smaller/gallos.webp", alt: "Soda Dulcelina: sección gallos" },
  { id: "comidas-rapidas", label: "Comidas rápidas", src: "/assets/smaller/comidarapida.webp", alt: "Soda Dulcelina: sección comidas rápidas" },
  { id: "otros", label: "Otros", src: "/assets/smaller/otros.webp", alt: "Soda Dulcelina: sección otros" },
  { id: "chicharrones", label: "Chicharrones", src: "/assets/smaller/chicharrones.webp", alt: "Soda Dulcelina: sección chicharrones" },
  { id: "bebidas", label: "Bebidas", src: "/assets/smaller/bebidas.webp", alt: "Soda Dulcelina: sección bebidas" }
];
---
<!DOCTYPE html>
<html lang="es">
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <title>Soda Dulcelina · Menú</title>
    <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  </head>
  <body>
    <main class="menu-shell" aria-label="Menú Soda Dulcelina">
      <nav class="menu-nav" aria-label="Navegación por categorías">
        <div class="menu-nav__inner">
          <a class="menu-nav__logo" href="#inicio" aria-label="Ir a inicio">
            <img src="/assets/logo.png" alt="Soda Dulcelina" />
          </a>
          {menuImages.map((image) => (
            <a class="menu-nav__link" href={`#${image.id}`} data-section={image.id}>
              {image.label}
            </a>
          ))}
        </div>
      </nav>
      <section class="menu-stack">
        {menuImages.map((image, index) => (
          <figure class="menu-panel" id={image.id}>
            <img
              src={image.src}
              alt={image.alt}
              loading={index === 0 ? "eager" : "lazy"}
              decoding="async"
            />
          </figure>
        ))}
      </section>
    </main>
    <aside class="social-fab" aria-label="Redes sociales">
      <a class="social-fab__btn is-facebook" href="https://www.facebook.com/SodaDulcelina" aria-label="Facebook" target="_blank" rel="noreferrer">
        <svg viewBox="0 0 24 24" aria-hidden="true">
          <path d="M18.77,7.46H14.5v-1.9c0-.9.6-1.1,1-1.1h3V.5h-4.33C10.24.5,9.5,3.44,9.5,5.32v2.15h-3v4h3v12h5v-12h3.85l.42-4Z" />
        </svg>
      </a>
      <a class="social-fab__btn is-instagram" href="https://www.instagram.com/sodadulcelina" aria-label="Instagram" target="_blank" rel="noreferrer">
        <svg viewBox="0 0 24 24" aria-hidden="true">
          <path d="M12,2.16c3.2,0,3.58,0,4.85.07,3.25.15,4.77,1.69,4.92,4.92.06,1.27.07,1.65.07,4.85s0,3.58-.07,4.85c-.15,3.23-1.66,4.77-4.92,4.92-1.27.06-1.65.07-4.85.07s-3.58,0-4.85-.07c-3.26-.15-4.77-1.7-4.92-4.92-.06-1.27-.07-1.65-.07-4.85s0-3.58.07-4.85C2.38,3.92,3.9,2.38,7.15,2.23,8.42,2.18,8.8,2.16,12,2.16ZM12,0C8.74,0,8.33,0,7.05.07c-4.27.2-6.78,2.71-7,7C0,8.33,0,8.74,0,12s0,3.67.07,4.95c.2,4.27,2.71,6.78,7,7C8.33,24,8.74,24,12,24s3.67,0,4.95-.07c4.27-.2,6.78-2.71,7-7C24,15.67,24,15.26,24,12s0-3.67-.07-4.95c-.2-4.27-2.71-6.78-7-7C15.67,0,15.26,0,12,0Zm0,5.84A6.16,6.16,0,1,0,18.16,12,6.16,6.16,0,0,0,12,5.84ZM12,16a4,4,0,1,1,4-4A4,4,0,0,1,12,16ZM18.41,4.15a1.44,1.44,0,1,0,1.44,1.44A1.44,1.44,0,0,0,18.41,4.15Z" />
        </svg>
      </a>
      <a class="social-fab__btn is-whatsapp" href="https://wa.me/50624604815" aria-label="WhatsApp" target="_blank" rel="noreferrer">
        <svg viewBox="0 0 24 24" aria-hidden="true">
          <path d="M17.472 14.382c-.297-.149-1.758-.867-2.03-.967-.273-.099-.471-.148-.67.15-.197.297-.767.966-.94 1.164-.173.199-.347.223-.644.075-.297-.15-1.255-.463-2.39-1.475-.883-.788-1.48-1.761-1.653-2.059-.173-.297-.018-.458.13-.606.134-.133.298-.347.446-.52.149-.174.198-.298.298-.497.099-.198.05-.371-.025-.52-.075-.149-.669-1.612-.916-2.207-.242-.579-.487-.5-.669-.51-.173-.008-.371-.01-.57-.01-.198 0-.52.074-.792.372-.272.297-1.04 1.016-1.04 2.479 0 1.462 1.065 2.875 1.213 3.074.149.198 2.096 3.2 5.077 4.487.709.306 1.262.489 1.694.625.712.227 1.36.195 1.871.118.571-.085 1.758-.719 2.006-1.413.248-.694.248-1.289.173-1.413-.074-.124-.272-.198-.57-.347m-5.421 7.403h-.004a9.87 9.87 0 01-5.031-1.378l-.361-.214-3.741.982.998-3.648-.235-.374a9.86 9.86 0 01-1.51-5.26c.001-5.45 4.436-9.884 9.888-9.884 2.64 0 5.122 1.03 6.988 2.898a9.825 9.825 0 012.893 6.994c-.003 5.45-4.437 9.884-9.885 9.884m8.413-18.297A11.815 11.815 0 0012.05 0C5.495 0 .16 5.335.157 11.892c0 2.096.547 4.142 1.588 5.945L.057 24l6.305-1.654a11.882 11.882 0 005.683 1.448h.005c6.554 0 11.89-5.335 11.893-11.893a11.821 11.821 0 00-3.48-8.413Z" />
        </svg>
      </a>
    </aside>
    <script is:inline>
      const navInner = document.querySelector(".menu-nav__inner");
      const links = Array.from(document.querySelectorAll(".menu-nav__link"));
      const sections = Array.from(document.querySelectorAll(".menu-panel"));

      const setActive = (id) => {
        links.forEach((link) => {
          const isActive = link.dataset.section === id;
          link.classList.toggle("is-active", isActive);
          if (isActive) {
            link.setAttribute("aria-current", "true");
          } else {
            link.removeAttribute("aria-current");
          }
        });
      };

      const scrollActiveIntoView = (id) => {
        const activeLink = links.find((link) => link.dataset.section === id);
        if (!activeLink || !navInner) return;
        activeLink.scrollIntoView({ behavior: "smooth", inline: "center", block: "nearest" });
      };

      const observer = new IntersectionObserver(
        (entries) => {
          const visible = entries
            .filter((entry) => entry.isIntersecting)
            .sort((a, b) => b.intersectionRatio - a.intersectionRatio)[0];
          if (visible?.target?.id) {
            setActive(visible.target.id);
            scrollActiveIntoView(visible.target.id);
          }
        },
        { rootMargin: "-20% 0px -55% 0px", threshold: [0.15, 0.35, 0.6] }
      );

      sections.forEach((section) => observer.observe(section));

      if (sections.length) {
        setActive(sections[0].id);
      }

      links.forEach((link) => {
        link.addEventListener("click", (event) => {
          const id = link.dataset.section;
          const target = id ? document.getElementById(id) : null;
          if (!target) return;
          event.preventDefault();
          target.scrollIntoView({ behavior: "smooth", block: "center" });
          setActive(id);
          scrollActiveIntoView(id);
        });
      });
    </script>
  </body>
</html>
